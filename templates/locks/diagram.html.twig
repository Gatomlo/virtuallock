{% extends 'base.html.twig' %}

{% block title %}VirtualLock{% endblock %}

{% block body %}

<div id="body">
  <div class="container">
    {% if lock.intro is not empty %}
    <div class="card intro">
      <div class="card-body">
        {{lock.intro | raw}}
      </div>
    </div>
    {% endif %}
    <div id="passZone">
      Entrer code
    </div>
    <div id="digit" class="row align-items-center">
      <div class="m-auto" id="lock"></div>
    </div>
    <div id="soluceZone"></div>
  </div>
</div>
{% endblock %}
{% block javascripts %}
  <script >
    var solution ='{{lock.solution}}';
    var solutionInArray = solution.split(',')
    var lock= new PatternLock('#lock',{
      lineOnMove:false,
      onDraw:function(data){
        var trying = data.split("");
        if (arraysAreIdentical(solutionInArray,trying)){
          if ('{{lock.url}}' == ''){
            $('#soluceZone').html('<div class="card outro"><div class="card-body">{{lock.finalTexte | raw}}</div></div>');
          }
          else{
            window.location.href = '{{lock.url}}';
          }
        }
        else{
          $('#soluceZone').append('<div id="message" class="alert alert-danger alert-dismissible fade show" role="alert">'+
          '<strong>Erreur!</strong>Sch√©ma incorrect.'+
          '<button type="button" class="close" data-dismiss="alert" aria-label="Close">'+
          '<span aria-hidden="true">&times;</span></button></div>')
        }
   }
    });
    function arraysAreIdentical(arr1, arr2){
      if (arr1.length !== arr2.length) return false;
      for (var i = 0, len = arr1.length; i < len; i++){
        if (arr1[i] !== arr2[i]){
        return false;
      }
    }
    return true;
    }
  </script>


{% endblock %}

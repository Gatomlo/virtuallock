{% extends 'base.html.twig' %}

{% block title %}VirtualLock{% endblock %}

{% block body %}

<div id="body">
  <div class="container">
    {% if lock.intro is not empty %}
    <div class="card intro">
      <div class="card-body">
        {{lock.intro | raw}}
      </div>
    </div>
    {% endif %}
    <div id="passZone">
      Veuillez vous connecter
    </div>
    <div id="loginBox" class="d-flex flex-column justify-content-center align-items-center" >
      <form>
        <div class="form-group">
          <input type="text" class="form-control" id="login" placeholder="Login">
        </div>
        <div class="form-group">
          <input type="password" class="form-control" id="password" placeholder="Mot de passe" >
        </div>
				<button id="send" class="btn btn-primary" type="button">Se connecter</button>
      </form>
    </div>
    <div id="soluceZone"></div>
  </div>
</div>
{% endblock %}
{% block javascripts %}
  <script>
    var solution = '{{lock.solution}}';
    var solutionInArray = solution.split(",")
    $('#send').click(function(){
      var email = $("#login").val();
      var mdp = $("#password").val();
      if(email == solutionInArray[0] && mdp == solutionInArray[1]){
        if ('{{lock.url}}' == ''){
          $('#soluceZone').html('<div class="card outro"><div class="card-body">{{lock.finalTexte | raw}}</div></div>');
        }
        else{
          window.location.href = '{{lock.url}}';
        }
      }
      else{
        $('#loginBox').append('<div id="message" class="alert alert-danger alert-dismissible fade show" role="alert">'+
      '<strong>Erreur!</strong> La combinaison email/mot de passe ne semble pas bonne.'+
      '<button type="button" class="close" data-dismiss="alert" aria-label="Close">'+
        '<span aria-hidden="true">&times;</span></button></div>')
      }
    })
  </script>

{% endblock %}
